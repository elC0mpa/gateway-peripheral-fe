(function(e){function t(t){for(var r,c,n=t[0],o=t[1],s=t[2],u=0,b=[];u<n.length;u++)c=n[u],Object.prototype.hasOwnProperty.call(l,c)&&l[c]&&b.push(l[c][0]),l[c]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);d&&d(t);while(b.length)b.shift()();return i.push.apply(i,s||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,n=1;n<a.length;n++){var o=a[n];0!==l[o]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=a[0]))}return e}var r={},l={app:0},i=[];function c(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=r,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(a,r,function(t){return e[t]}.bind(null,r));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/gateway-peripheral-fe/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var s=0;s<n.length;s++)t(n[s]);var d=o;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},cd49:function(e,t,a){"use strict";a.r(t);var r=a("7a23");function l(e,t,a,l,i,c){const n=Object(r["J"])("GatewaysTable");return Object(r["D"])(),Object(r["k"])(n)}const i=Object(r["n"])("p",null,"No gateway created yet",-1),c=Object(r["o"])("Create gateway");function n(e,t,a,l,n,o){const s=Object(r["J"])("peripherals-table"),d=Object(r["J"])("PlusOutlined"),u=Object(r["J"])("a-button"),b=Object(r["J"])("DeleteOutlined"),p=Object(r["J"])("a-popconfirm"),O=Object(r["J"])("a-table"),y=Object(r["J"])("create-gateway-modal");return Object(r["D"])(),Object(r["m"])(r["b"],null,[Object(r["p"])(O,{columns:e.columns,"data-source":e.gateways,pagination:!1,loading:e.isLoading,rowKey:"serialNumber",scroll:{x:600}},{expandedRowRender:Object(r["U"])(({record:t})=>[Object(r["p"])(s,{gatewayId:t._id,peripherals:t.peripherals,onRefresh:e.refreshGateways},null,8,["gatewayId","peripherals","onRefresh"])]),headerCell:Object(r["U"])(({column:a})=>["actions"===a.key?(Object(r["D"])(),Object(r["m"])(r["b"],{key:0},[Object(r["p"])(u,{type:"primary",shape:"circle",onClick:t[0]||(t[0]=t=>e.createGatewayModalVisibility=!0)},{icon:Object(r["U"])(()=>[Object(r["p"])(d)]),_:1}),Object(r["o"])(" "+Object(r["M"])(a.title),1)],64)):Object(r["l"])("",!0)]),bodyCell:Object(r["U"])(({column:t,record:a})=>["actions"===t.key?(Object(r["D"])(),Object(r["k"])(p,{key:0,title:"Are you sure you want to delete this gateway?",okType:"danger",onConfirm:t=>e.onDeleteGateway(a)},{default:Object(r["U"])(()=>[Object(r["p"])(u,{type:"danger",shape:"circle"},{icon:Object(r["U"])(()=>[Object(r["p"])(b)]),_:1})]),_:2},1032,["onConfirm"])):Object(r["l"])("",!0)]),emptyText:Object(r["U"])(()=>[i,Object(r["p"])(u,{type:"primary",onClick:t[1]||(t[1]=t=>e.createGatewayModalVisibility=!0)},{default:Object(r["U"])(()=>[c]),_:1})]),_:1},8,["columns","data-source","loading"]),Object(r["p"])(y,{isVisible:e.createGatewayModalVisibility,onClose:t[2]||(t[2]=t=>e.createGatewayModalVisibility=!1),onSuccess:e.gatewayCreated},null,8,["isVisible","onSuccess"])],64)}var o=a("bc3a"),s=a.n(o);const d=s.a.create({baseURL:"https://musala-test-be.herokuapp.com/"}),u=()=>new Promise((e,t)=>{d.get("gateway/").then(t=>{const{data:a}=t,{items:r}=a;e(r)}).catch(e=>{e.response?t(e.response.data):e.request&&t(e.request)})}),b=e=>new Promise((t,a)=>{d.delete("gateway/"+e).then(e=>{const{data:a}=e,{items:r}=a;t(r)}).catch(e=>{e.response?a(e.response.data):e.request&&a(e.request)})}),p=(e,t,a)=>new Promise((r,l)=>{d.post("gateway/",{serialNumber:e,address:t,label:a}).then(e=>{const{data:t}=e,{items:a}=t;r(a)}).catch(e=>{e.response?l(e.response.data):e.request&&l(e.request)})}),O=e=>new Promise((t,a)=>{d.delete("peripheral/"+e).then(e=>{const{data:a}=e,{items:r}=a;t(r)}).catch(e=>{e.response?a(e.response.data):e.request&&a(e.request)})}),y=(e,t,a,r)=>new Promise((l,i)=>{d.post("peripheral/",{gateway:e,vendor:t,uid:a,status:r}).then(e=>{const{data:t}=e,{items:a}=t;l(a)}).catch(e=>{e.response?i(e.response.data):e.request&&i(e.request)})});var j=a("56cd");a("8b35");const m=(e,t,a="")=>{const r={message:t,description:a};"success"===e?j["a"].success(r):"warning"===e?j["a"].warning(r):j["a"].error(r)},f=e=>{const t=[];if(e.error.errors){const{errors:a}=e.error;Object.keys(a).forEach(e=>{t.push(a[e].message)})}return 11e3===e.error.code&&t.push("Serial Number must be unique"),t.join("\n")},h=e=>{const t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()} ${t.getHours()}:${t.getMinutes()}`};function g(e,t,a,l,i,c){const n=Object(r["J"])("a-input"),o=Object(r["J"])("a-form-item"),s=Object(r["J"])("a-form"),d=Object(r["J"])("modal");return Object(r["D"])(),Object(r["k"])(d,{visible:e.isVisible,"mask-closable":!1,"confirm-loading":e.data.isLoading,title:"Create Gateway",onCancel:e.emitCloseEvent,onOk:e.fieldsValidation},{default:Object(r["U"])(()=>[Object(r["p"])(s,{model:e.data,"label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",name:"form_in_modal",ref:"formRef"},{default:Object(r["U"])(()=>[Object(r["p"])(o,{label:"Serial Number",name:"uniqueSerialNumber",rules:[{required:!0,message:"Serial Number is required!"}]},{default:Object(r["U"])(()=>[Object(r["p"])(n,{value:e.data.uniqueSerialNumber,"onUpdate:value":t[0]||(t[0]=t=>e.data.uniqueSerialNumber=t),placeholder:"Serial Number","allow-clear":!0},null,8,["value"])]),_:1}),Object(r["p"])(o,{label:"Label",name:"label",rules:[{required:!0,message:"Label is required!"}]},{default:Object(r["U"])(()=>[Object(r["p"])(n,{value:e.data.label,"onUpdate:value":t[1]||(t[1]=t=>e.data.label=t),placeholder:"Label","allow-clear":!0},null,8,["value"])]),_:1}),Object(r["p"])(o,{label:"IP Address",name:"address",rules:[{required:!0,message:"IP Address is required!"},{validator:e.ipAddressValidation}]},{default:Object(r["U"])(()=>[Object(r["p"])(n,{value:e.data.address,"onUpdate:value":t[2]||(t[2]=t=>e.data.address=t),placeholder:"IP Address","allow-clear":!0},null,8,["value"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading","onCancel","onOk"])}a("d9e2");const w=(e,t)=>/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)(\.(?!$)|$)){4}$/.test(t)?Promise.resolve():Promise.reject(new Error("This is not a valid IP Address"));var v=a("ed3b"),k=a("b558"),P=a("3af3"),U=a("322e"),q=(a("cd09"),a("1325"),a("ad26"),Object(r["q"])({name:"CreateGatewayModal",components:{Modal:v["a"],AInput:k["a"],AForm:P["a"],AFormItem:U["a"]},props:{isVisible:{type:Boolean,required:!0}},setup(e,t){const a=Object(r["G"])(),l=Object(r["F"])({uniqueSerialNumber:"",address:"",label:"",isLoading:!1}),i=()=>{var e;null===(e=a.value)||void 0===e||e.resetFields(),t.emit("close")},c=async()=>{try{var e;l.isLoading=!0,await p(l.uniqueSerialNumber,l.address,l.label),m("success","Gateway succesfully created"),null===(e=a.value)||void 0===e||e.resetFields(),t.emit("success")}catch(r){const e=f(r);m("error","Gateway couldn´t be created",e)}finally{l.isLoading=!1}},n=async()=>{try{var e;await(null===(e=a.value)||void 0===e?void 0:e.validateFields()),await c()}catch(t){console.log("Validation error info: ",t)}};return{props:e,emitCloseEvent:i,data:l,fieldsValidation:n,formRef:a,ipAddressValidation:w}}})),C=a("d959"),V=a.n(C);const _=V()(q,[["render",g]]);var A=_;const I=Object(r["n"])("p",null,"No peripheral created yet",-1),M=Object(r["o"])("Create peripheral");function D(e,t,a,l,i,c){const n=Object(r["J"])("DeleteOutlined"),o=Object(r["J"])("a-button"),s=Object(r["J"])("a-popconfirm"),d=Object(r["J"])("a-switch"),u=Object(r["J"])("PlusOutlined"),b=Object(r["J"])("a-table"),p=Object(r["J"])("create-peripheral-modal");return Object(r["D"])(),Object(r["m"])(r["b"],null,[Object(r["p"])(b,{columns:e.columns,"data-source":e.peripherals,pagination:!1,loading:e.isLoading,scroll:{x:600}},{bodyCell:Object(r["U"])(({column:t,record:a})=>["createdAt"===t.key?(Object(r["D"])(),Object(r["m"])(r["b"],{key:0},[Object(r["o"])(Object(r["M"])(e.formatDate(a.createdAt)),1)],64)):Object(r["l"])("",!0),"actions"===t.key?(Object(r["D"])(),Object(r["k"])(s,{key:1,title:"Are you sure you want to delete this peripheral?",okType:"danger",onConfirm:t=>e.onDeletePeripheral(a)},{default:Object(r["U"])(()=>[Object(r["p"])(o,{type:"danger",shape:"circle"},{icon:Object(r["U"])(()=>[Object(r["p"])(n)]),_:1})]),_:2},1032,["onConfirm"])):Object(r["l"])("",!0),"status"===t.key?(Object(r["D"])(),Object(r["k"])(d,{key:2,checked:a.status,"onUpdate:checked":e=>a.status=e,"checked-children":"ON","un-checked-children":"OFF",disabled:!0},null,8,["checked","onUpdate:checked"])):Object(r["l"])("",!0)]),headerCell:Object(r["U"])(({column:a})=>["actions"===a.key?(Object(r["D"])(),Object(r["m"])(r["b"],{key:0},[Object(r["p"])(o,{type:"primary",shape:"circle",onClick:t[0]||(t[0]=t=>e.createPeripheralModalVisibility=!0)},{icon:Object(r["U"])(()=>[Object(r["p"])(u)]),_:1}),Object(r["o"])(" "+Object(r["M"])(a.title),1)],64)):Object(r["l"])("",!0)]),emptyText:Object(r["U"])(()=>[I,Object(r["p"])(o,{type:"primary",onClick:t[1]||(t[1]=t=>e.createPeripheralModalVisibility=!0)},{default:Object(r["U"])(()=>[M]),_:1})]),_:1},8,["columns","data-source","loading"]),Object(r["p"])(p,{isVisible:e.createPeripheralModalVisibility,gatewayId:e.gatewayId,onClose:t[2]||(t[2]=t=>e.createPeripheralModalVisibility=!1),onSuccess:e.peripheralCreated},null,8,["isVisible","gatewayId","onSuccess"])],64)}var J=a("47ce"),S=a("b1c8");function L(e,t,a,l,i,c){const n=Object(r["J"])("a-input"),o=Object(r["J"])("a-form-item"),s=Object(r["J"])("a-switch"),d=Object(r["J"])("a-form"),u=Object(r["J"])("modal");return Object(r["D"])(),Object(r["k"])(u,{visible:e.isVisible,"mask-closable":!1,"confirm-loading":e.data.isLoading,title:"Create Peripheral",onCancel:e.emitCloseEvent,onOk:e.fieldsValidation},{default:Object(r["U"])(()=>[Object(r["p"])(d,{model:e.data,"label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",name:"form_in_modal",ref:"formRef"},{default:Object(r["U"])(()=>[Object(r["p"])(o,{label:"Vendor",name:"vendor",rules:[{required:!0,message:"Vendor is required!"}]},{default:Object(r["U"])(()=>[Object(r["p"])(n,{value:e.data.vendor,"onUpdate:value":t[0]||(t[0]=t=>e.data.vendor=t),placeholder:"Vendor","allow-clear":!0},null,8,["value"])]),_:1}),Object(r["p"])(o,{label:"UID",name:"uid",rules:[{required:!0,message:"UID is required!"}]},{default:Object(r["U"])(()=>[Object(r["p"])(n,{value:e.data.uid,"onUpdate:value":t[1]||(t[1]=t=>e.data.uid=t),placeholder:"UID",type:"number"},null,8,["value"])]),_:1}),Object(r["p"])(o,{label:"Status",name:"status"},{default:Object(r["U"])(()=>[Object(r["p"])(s,{checked:e.data.status,"onUpdate:checked":t[2]||(t[2]=t=>e.data.status=t),"checked-children":"ON","un-checked-children":"OFF"},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading","onCancel","onOk"])}var G=a("160c"),F=(a("99bf"),a("f762"),Object(r["q"])({name:"CreatePeripheralModal",components:{Modal:v["a"],AInput:k["a"],ASwitch:G["a"],AForm:P["a"],AFormItem:U["a"]},props:{isVisible:{type:Boolean,required:!0},gatewayId:{type:String,required:!0}},setup(e,t){const a=Object(r["G"])(),l=Object(r["F"])({vendor:"",uid:"",status:!1,isLoading:!1}),i=()=>{var e;null===(e=a.value)||void 0===e||e.resetFields(),t.emit("close")},c=async()=>{try{var r;l.isLoading=!0,await y(e.gatewayId,l.vendor,Number(l.uid),l.status),m("success","Peripheral succesfully created"),null===(r=a.value)||void 0===r||r.resetFields(),t.emit("success")}catch(i){const e=f(i);m("error","Peripheral couldn´t be created",e)}finally{l.isLoading=!1}},n=async()=>{try{var e;await(null===(e=a.value)||void 0===e?void 0:e.validateFields()),await c()}catch(t){console.log("Validation error info: ",t)}};return{props:e,emitCloseEvent:i,data:l,formRef:a,fieldsValidation:n}}}));const N=V()(F,[["render",L]]);var x=N,T=a("0020"),E=a("5efb"),R=a("768f"),$=(a("5785"),a("84d1"),Object(r["q"])({name:"PeripheralsTable",components:{ATable:T["a"],AButton:E["a"],PlusOutlined:J["a"],DeleteOutlined:S["a"],CreatePeripheralModal:x,ASwitch:G["a"],APopconfirm:R["a"]},props:{peripherals:{type:Array,required:!0},gatewayId:{type:String,required:!0}},emits:["refresh"],setup(e,t){const a=Object(r["F"])({columns:[{title:"Status",dataIndex:"status",key:"status"},{title:"UID",dataIndex:"uid",key:"uid"},{title:"Vendor",dataIndex:"vendor",key:"vendor"},{title:"Created At",dataIndex:"createdAt",key:"createdAt"},{title:"Actions",key:"actions"}],isLoading:!1,createPeripheralModalVisibility:!1}),l=async()=>{a.createPeripheralModalVisibility=!1,t.emit("refresh")},i=async e=>{try{a.isLoading=!0,await O(e._id),m("success","Peripheral succesfully deleted"),t.emit("refresh")}catch(r){console.log("Error while deleting gateway: ",r)}finally{a.isLoading=!1}};return{...Object(r["P"])(a),props:e,peripheralCreated:l,onDeletePeripheral:i,formatDate:h}}}));const B=V()($,[["render",D]]);var H=B,K=Object(r["q"])({name:"GatewaysTable",components:{ATable:T["a"],AButton:E["a"],DeleteOutlined:S["a"],APopconfirm:R["a"],PeripheralsTable:H,CreateGatewayModal:A,PlusOutlined:J["a"]},setup(){const e=Object(r["F"])({columns:[{title:"Serial Number",dataIndex:"serialNumber",key:"serialNumber"},{title:"Label",dataIndex:"label",key:"label"},{title:"IPv4 address",dataIndex:"address",key:"address"},{title:"Actions",key:"actions"}],gateways:[],isLoading:!0,createGatewayModalVisibility:!1,peripheralsModalVisibility:!1}),t=async t=>{try{e.isLoading=!0,await b(t._id),m("success","Gateway succesfully deleted"),await a()}catch(r){console.log("Error while deleting gateway: ",r)}finally{e.isLoading=!1}},a=async()=>{try{e.isLoading=!0,e.gateways=await u()}catch(t){console.log("Error while getting gateways")}finally{e.isLoading=!1}},l=async()=>{e.createGatewayModalVisibility=!1,await a()};return a(),{...Object(r["P"])(e),onDeleteGateway:t,gatewayCreated:l,refreshGateways:a}}});const Y=V()(K,[["render",n]]);var z=Y,Q=Object(r["q"])({name:"App",components:{GatewaysTable:z}});const W=V()(Q,[["render",l]]);var X=W;Object(r["j"])(X).mount("#app")}});
//# sourceMappingURL=app.4c7a01cf.js.map